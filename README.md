# Backend API Dashboard & Monitoring

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç Backend API —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º —á–µ—Ä–µ–∑ Prometheus/Grafana/Loki.

---

## üì¶ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Docker Compose

1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/mr-st0rm/FastAPIBackendMetrics.git
cd FastAPIBackendMetrics
```
2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É
`docker compose up -d`

–≠—Ç–æ –ø–æ–¥–Ω–∏–º–µ—Ç:
* backend-api ‚Äì FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç—É 8080
* database ‚Äì PostgreSQL
* prometheus ‚Äì Prometheus –Ω–∞ –ø–æ—Ä—Ç—É 9090
* grafana ‚Äì Grafana –Ω–∞ –ø–æ—Ä—Ç—É 3000
* loki ‚Äì Loki –Ω–∞ –ø–æ—Ä—Ç—É 3100
* promtail ‚Äì —Å–±–æ—Ä—â–∏–∫ –ª–æ–≥–æ–≤
* node-exporter ‚Äì –º–µ—Ç—Ä–∏–∫–∏ –Ω–æ–¥—ã –Ω–∞ –ø–æ—Ä—Ç—É 9100

‚ö†Ô∏è Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.

---
## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus:
* CPU Usage ‚Äì –Ω–∞–≥—Ä—É–∑–∫–∞ CPU (node_cpu_seconds_total)
* Memory Usage ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (node_memory_*)
* Disk Usage ‚Äì –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∏—Å–∫–æ–≤ (node_filesystem_*)
* HTTP Requests Rate ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ (http_requests_total)
* HTTP 95th percentile latency ‚Äì –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ (http_request_duration_seconds_bucket)
* Backend Memory Usage ‚Äì –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ FastAPI (process_resident_memory_bytes)
* Errors ‚Äì –æ—à–∏–±–∫–∏ HTTP 4xx/5xx:
```
sum(rate(http_requests_total{status=~"4..|5.."}[1m]))
```
–õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ–±–∏—Ä–∞—é—Ç—Å—è Promtail ‚Üí Loki –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Grafana.
–î–æ–±–∞–≤–ª–µ–Ω Alert –Ω–∞ –≤—ã—Å–æ–∫—É—é –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å - HighLatency.
---
## üìå Grafana: –¥–∞—à–±–æ—Ä–¥—ã

–î–∞—à–±–æ—Ä–¥—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ infra/dashboards/. –ß—Ç–æ–±—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å JSON:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Grafana (http://localhost:3000)
2. –í –º–µ–Ω—é —Å–ª–µ–≤–∞: Dashboards ‚Üí Manage ‚Üí Import
3. –í—ã–±–µ—Ä–∏—Ç–µ JSON —Ñ–∞–π–ª –∏–∑ infra/dashboards/
4. –í—ã–±–µ—Ä–∏—Ç–µ Datasource Prometheus –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ Loki –¥–ª—è –ª–æ–≥–æ–≤

–î–∞—à–±–æ—Ä–¥—ã –≤–∫–ª—é—á–∞—é—Ç: CPU/Memory/Disk, HTTP –∑–∞–ø—Ä–æ—Å—ã, latency, network, –æ—à–∏–±–∫–∏ –∏ –ª–æ–≥–∏.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –¥–ª—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ pytest
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è /metrics
–¢–µ—Å—Ç—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ë–î.

–ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ, –≤–≤–µ–¥–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏
`pytest -v tests/`
---
## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫

* Prometheus: http://localhost:9090
* Grafana: http://localhost:3000
* Loki: http://localhost:3100

–ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç—É http://localhost:8080/metrics –≤ FastAPI.

---

### –í–∞—Ä–∏–∞–Ω—Ç—ã —É–ª—É—á—à–µ–Ω–∏—è:

- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –ø—Ä–æ–¥–∞–∫—à–Ω-–¥–µ–ø–ª–æ–π
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker Swarm / Kubernetes –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è API –∏ Prometheus/Grafana.
    - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ replica set –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (Postgres replication).
    - –ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥ HTTP —Å–µ—Ä–≤–∏—Å–∞ –ø–æ –Ω–∞–≥—Ä—É–∑–∫–µ.
- –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
  - –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
    - latency per endpoint
    - DB query duration
    - cache hit/miss
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å alertmanager –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Slack/Telegram/email.
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
  - –ü–æ–∫—Ä—ã—Ç–∏–µ pytest + async tests –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å factory-boy / faker –¥–ª—è –º–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö.
  - –î–æ–±–∞–≤–∏—Ç—å load tests (Locust, k6) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ real bottlenecks.
  - –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã(–≤–º–µ—Å—Ç–µ —Å —Ä–∞–±–æ—Ç–æ–π —Å –ë–î)
- –õ–æ–≥–∏ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Grafana Alert on Logs (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–∑–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ 5xx).
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - –°–µ–∫—Ä–µ—Ç—ã (–ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã) —á–µ—Ä–µ–∑ Docker secrets / Vault.
  - HTTPS/TLS –¥–ª—è API.
  - Rate-limiting –∏ authentication –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.
  - –í—ã–Ω–æ—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î/—Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- DevOps –∏ CI/CD
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GitHub Actions / GitLab CI –¥–ª—è:
    - –õ–∏–Ω—Ç–∏–Ω–≥–∞ –∫–æ–¥–∞
    - –ê–≤—Ç–æ-—Ç–µ—Å—Ç–æ–≤
    - –ë–∏–ª–¥–∞ Docker –æ–±—Ä–∞–∑–æ–≤
    - –î–µ–ø–ª–æ—è –Ω–∞ staging
- –ú–æ–∫ –¥–∞–Ω–Ω—ã–µ
  - —Å–¥–µ–ª–∞—Ç—å –µ–¥–∏–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–∫ –¥–∞–Ω–Ω—ã—Ö(fixtures) –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä –ø–æ—Å–ª–µ –∏–ª–∏ –¥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ –º–∞—à–∏–Ω–µ —Å –ë–î